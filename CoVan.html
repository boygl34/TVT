<!DOCTYPE html>
<html>
<title>TVT</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-teal.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<meta name="apple-mobile-web-app-capable" content="yes" /> 
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
<link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
<link rel="stylesheet" type="text/css"	href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
<link rel="stylesheet" href="css/style.css">

<style>
    input:invalid {
  border-color: red;
}
input:valid {
  background: lightgreen;
}
select:valid {
  background: lightgreen;
}
  select:invalid {
  border-color: red;
}
.btn-group-xs > .btn, .btn-xs {
  padding: .25rem .4rem;
  font-size: .875rem;
  line-height: .5;
  border-radius: .2rem;
}

.DangTiepNhan{
   color: #00ff00;
}  
   .SapTiepNhan{
    color: #ff6d01;
   }
    .ChoTiepNhan{
    color: #3deedf;
   }
  .DangSuaChua{
    color: #00ff00;
   }
   .DaTiepNhan{
    color: #00bfff;
   }
   .DungCongViec{
    color: #ff4d4d;
   }
   .ChoSuaChua{
    color: #287aee;
   }
   .ChoGiaoXe{
    color: #FFE4C4;
   }
   .note1{  color: red;}
    .note2{  color: #bf00ff;}

  table.dataTable thead {background-color:#1155cc;
  font-size: 8px;}
  
  table.dataTable td{
    vertical-align: bottom;
     font-size: 14px;
    }
  #tablehen td:nth-child(0) {
        width: 10%;
        font-size: 14px;
  }
   #table-TimXe   td {
   font-size: calc(14px + (26 - 14) * ((100vw - 300px) / (1200 - 300)));
  vertical-align: middle;
  
  text-align: left  ;
   border: 1px solid black;
  border-bottom: 1px solid blue;
  margin: auto;
}
table thead {background-color:#1155cc;
  font-size: 10px;}
#table-TimXe .DangSuaChua{
   color: #00ff00;
}
#table-TimXe .ChoSuaChua{
   color: yellow;
}
#table-TimXe .ChuaSuaChua{
   color: gray;
}
#table-TimXe .DungSuaChua{
   color: red;
}
.DangRuaXe{
   color: #00ff00;
}  
   .ChoRuaXe{
    color: #ff6d01;
   }
 #tableRuaXe   td {
   font-size: 30px;
  vertical-align: middle;
  text-align: left  ;
   border: 1px solid black;
  border-bottom: 1px solid blue;
  margin: auto;
}
   #tableRuaXe td:nth-child(8) {
        width: 1%;
        font-size: 1px;
    } 
     #tableRuaXe td:nth-child(5) {
        width: 7%;
        font-size: 14px;
    } 
    #tableRuaXe td:nth-child(4) {
        width: 7%;
        font-size: 14px;
    } 
    #tableRuaXe td:nth-child(3) {
        width: 4%;
        font-size: 14px;
    } 
  #tableRuaXe td:nth-child(2) { 
        font-size: 50px;
    } 
body {font-family: "Roboto", sans-serif}
.w3-bar-block .w3-bar-item {
  padding: 16px;
  font-weight: bold;
}
</style>
<body>
<nav class="w3-sidebar w3-bar-block w3-collapse w3-animate-left w3-card" style="z-index:3;width:150px;" id="mySidebar">
  <a class="w3-bar-item w3-button w3-border-bottom w3-large" href="main.html">Toyota TVT</a>
  <a class="w3-bar-item w3-button w3-hide-large w3-large" href="javascript:void(0)" onclick="w3_close()">Close <i class="fa fa-remove"></i></a>
  <a class="w3-bar-item w3-button w3-teal" href="CoVan.html" id="name">Home</a>
  <a class="w3-bar-item w3-button"  href="Body.html">Đồng Sơn</a>
  <a class="w3-bar-item w3-button" href="LeTan.html">Lễ Tân</a>
  <a class="w3-bar-item w3-button" href="DatHen.html">Đặt Hẹn</a>
  <a class="w3-bar-item w3-button" href="EMSCC.html">EM GJ</a>
  <div>
    <a class="w3-bar-item w3-button" onclick="myAccordion('demo')" href="javascript:void(0)">Tính Năng <i class="fa fa-caret-down"></i></a>
    <div id="demo" class="w3-hide">
      <a class="w3-bar-item w3-button" href="LichCV.html">Lịch CV</a>
    </div>
  </div>
</nav>
<div class="w3-overlay w3-hide-large w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" id="myOverlay"></div>
<div class="w3-main" style="margin-left:150px;">
<div id="myTop" class="w3-container w3-top w3-theme w3-large">
  <p><i class="fa fa-bars w3-button w3-teal w3-hide-large w3-xlarge" onclick="w3_open()"></i>
  <span id="myIntro" class="w3-hide">Dịch Vụ Toyota Vũng Tàu</span></p>
</div>
<header class="w3-container w3-theme" style="padding:13px 32px">
  <h1 class="w3-xlarge">Cố Vấn<button type="button" class="btn btn-primary" id = "DungTN"  class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" onclick="DungTN()">Dừng TN</button></h1> 
  
          <div  id="LichCoVan"></div>
 

</header>
<div class="w3-container" id="TrangDangNhap" style="padding:13px"><div id="alert" style="position: absolute; top: 10px; right: 10px;"></div>
        <!-- body" -->
      
    <div class="row">
        <div class="col-lg-3">
            <form id="myForm" class="p-2 border border-light rounded " style="background:#9BB7D4" > 
            <p class="h4 mb-4 text-center"id="tieude"></p>
            <div id="message"><div class='alert alert-success'>Hello!!!</div></div>
            <input type="text" id="MaSo" name="MaSo" value="" style="display:none ">

            <div class="form-group">
            <label for="BienSo" >Biển Số</label>
            <input type="text" class="form-control" id="BienSoXe" name="BienSo" placeholder="Biển Số" required style="font-size:2.575em;font-weight:bold;" onchange="changvalue()" onkeyup="this.value = suabienso(this.value)"required>
            </div>
            <div class="form-row">
            <div class="form-group col-md-6">
              <button type="button" class="btn btn-primary" id = "KhachRX"  value="Rửa Xe" onclick="KhachRua()">Rửa Xe</button> 
            
            </div>	
            <div class="form-group col-md-6">
              <button type="button" class="btn btn-primary" id = "KhachDoi"  value="Khách Đợi" onclick="Khachdoi()">Khách Đợi</button>
            </div>
            </div>  
            <script>
               function Khachdoi(){
                var buttonkd = document.getElementById("KhachDoi")
                if(buttonkd.value=="Khách Đợi"){
                  buttonkd.value = "Không Đợi";
                  buttonkd.innerHTML = "Không Đợi";
                  buttonkd.removeAttribute("class","btn-primary");
                  buttonkd.setAttribute("class"," btn btn-success")
                }
                else{
                  buttonkd.value = "Khách Đợi";
                  buttonkd.innerHTML = "Khách Đợi";
                  buttonkd.removeAttribute("class","btn-success");
                  buttonkd.setAttribute("class","btn btn-primary")}
               }
               function KhachRua(){
                var buttonkd = document.getElementById("KhachRX")
                if(buttonkd.value=="Rửa Xe"){
                  buttonkd.value = "Không Rửa";
                  buttonkd.innerHTML = "Không Rửa";
                  buttonkd.removeAttribute("class","btn-primary");
                  buttonkd.setAttribute("class"," btn btn-success")
                }
                else{
                  buttonkd.value = "Rửa Xe";
                  buttonkd.innerHTML = "Rửa Xe";
                  buttonkd.removeAttribute("class","btn-success");
                  buttonkd.setAttribute("class","btn btn-primary")}
               }
 

            </script>
            <div class="form-row"> 
            <div class="form-group col-md-6">
            <label for="exampleFormControlSelect1">Loại Hình GJ </label>
            <select  class="form-control"  id="LoaiHinh" name="LoaiHinh" required >
            '<option value=""></option>'
            '<option value="EM">EM</option>'
            '<option value="EM60">EM60</option>'
            '<option value="SCC">SCC</option>'
            '<option value="Báo Giá SCC">Báo Giá SCC</option>'
            '<option value="FIR">FIR</option>'
            </select>
            </div>
            <div class="form-group col-md-6">
            <label for="exampleFormControlSelect1">Loại Hình BP </label>
            <select  class="form-control"  id="LoaiHinhBP" name="LoaiHinhBP" required >
            '<option value=""></option>'
            '<option value="Đồng Sơn">Đồng Sơn</option>'
            '<option value="Báo Giá BH">Báo Giá BH</option>'
            '<option value="FIR">FIR</option>'
            </select>
            </div>
            </div>


            <div class="form-row"> 
            <div class="form-group col-md-8" >
            <label for="NgayGiaoXe">Ngày Giao Xe</label>
            <input type="text"  data-date-format="dd/mm/yyyy" class="form-control Ngay" id="NgayGiaoXe" name="NgayGiaoXe" required>

            </div>

            </div>
            <div class="form-row">
            <div id="NutNhan">
            </div>&emsp;

            <input class="btn btn-secondary" type="reset" value="Reset">
            </div>
            </form>
        </div>
        <div class="col-lg-9"> 
                <div id="tablehen" class="table-responsive">
                  <table id="data-table" onclick = "clickTableTiepNhan()"class=" table table-dark  table-sm table-hover  row-border"style="font-weight:bold ;width:100%;background-color:black">
                                <thead style="color:black;font-weight:bold ;font-size:8px;background-color:#1155cc">
                                <tr>
                                  <th style=" width: 15%;">Biển Số</th>
                                  <th style=" width: 20%;">Tên KH</th>
                                  <th >Trang Thái</th>
                                  <th >LH SCC</th>
                                  <th >LH ĐS</th>
                                  <th>Rửa Xe</th>
                                  <th>KhĐợi</th>
                                  
                                  <th>Giờ Hẹn</th>
                                  <th >Tiến Độ(h)</th>
                                </tr>
                              </thead>
                              <tbody id="table-body"  >
                              </tbody>
                            </table>
                </div>
                 
        </div>
      </div>   
<!-- Button trigger modal -->


<!-- Modal -->
<div class="modal " id="exampleModal" tabindex="-1" data-keyboard="false" data-backdrop="static" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Dừng Tiếp Nhận</h5>
        <!--button type="button" class="close" data-dismiss="modal" aria-label="Close"-->
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="thongtindung">
        ...
      </div>
      <div class="modal-footer">
        <button type="button" data-dismiss="modal" class="btn btn-primary" onclick="BATDAUTIEPNHAN()">Tiếp Nhận!!</button>
      </div>
    </div>
  </div>
</div>
	
	<script src="js/background.js"></script>
	<script src="js/popper.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/mainCV.js"></script>
<script src="js/timelineCV.js"></script>






</div>
<footer class="w3-container w3-theme" style="padding:32px">
  <p>Footer information goes here</p>
</footer>
     


<script>
     checkdangnhap()

function DungTN(){
  var result = prompt("Lý do dừng:", "");
if(result != null)  {
    var json2 = {
      TrangThai: "DungTN",
      LyDo: result,
      ThoiGianDung: TimesClick() 
               } 
      $.ajax({
            url:"https://big-road-newsstand.glitch.me/Setting/"+localStorage.getItem("Ten"),
            type:'PATCH',
            data:json2
          })
          CheckTrangThaiTN()    
  
}
}
function BATDAUTIEPNHAN(){
  let text = "Bạn bắt đầu tiếp nhận lại ?"
  if (confirm(text) == true) { 
    var json2 = {
      TrangThai: "DangTN",
      LyDo: "",
      ThoiGianDung: "" 
               } 
      $.ajax({
            url:"https://big-road-newsstand.glitch.me/Setting/"+localStorage.getItem("Ten"),
            type:'PATCH',
            data:json2
          })
  
}
} 
CheckTrangThaiTN()
function CheckTrangThaiTN(){
  $.get("https://big-road-newsstand.glitch.me/Setting/"+localStorage.getItem("Ten"), function(ketqua) {
    if(ketqua.TrangThai=="DungTN"){
      $('#exampleModal').modal('show')
      $('#thongtindung').html("Lý Do : "+ketqua.LyDo+"<br> Từ lúc : "+ketqua.ThoiGianDung)
    }
    
   } );
}  


function checkdangnhap() {
  var urluser = "https://big-road-newsstand.glitch.me/User/"
  var password = localStorage.getItem("Password")
  var use =localStorage.getItem("id")
  document.getElementById("TrangDangNhap").hidden=true  
  if(password&&use){
    fetch(urluser+use)
    .then(response => response.json())
    .then(data =>{
    if(password==data.Password){
      if(data.PhanQuyen!=="CoVandichvu"&&data.PhanQuyen!=="admin"){$('#TrangDangNhap').hide();}
      document.getElementById("TrangDangNhap").hidden=false;
      document.getElementById("name").innerHTML =  localStorage.getItem("userName")}else{ 
        document.getElementById("TrangDangNhap").hidden=true  
      }
  })
  }
}

// Open and close the sidebar on medium and small screens
function w3_open() {
  document.getElementById("mySidebar").style.display = "block";
  document.getElementById("myOverlay").style.display = "block";
}

function w3_close() {
  document.getElementById("mySidebar").style.display = "none";
  document.getElementById("myOverlay").style.display = "none";
}

// Change style of top container on scroll
window.onscroll = function() {myFunction()};
function myFunction() {
  if (document.body.scrollTop > 80 || document.documentElement.scrollTop > 80) {
    document.getElementById("myTop").classList.add("w3-card-4", "w3-animate-opacity");
    document.getElementById("myIntro").classList.add("w3-show-inline-block");
  } else {
    document.getElementById("myIntro").classList.remove("w3-show-inline-block");
    document.getElementById("myTop").classList.remove("w3-card-4", "w3-animate-opacity");
  }
}

// Accordions
function myAccordion(id) {
  var x = document.getElementById(id);
  if (x.className.indexOf("w3-show") == -1) {
    x.className += " w3-show";
    x.previousElementSibling.className += " w3-theme";
  } else { 
    x.className = x.className.replace("w3-show", "");
    x.previousElementSibling.className = 
    x.previousElementSibling.className.replace(" w3-theme", "");
  }
}
</script>
     
</body>
</html> 
