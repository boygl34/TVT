<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<style>
html {
  box-sizing: border-box;
}

*, *:before, *:after {
  box-sizing: inherit;
}

.column {
  float: left;
  width: 33.3%;
  margin-bottom: 16px;
  padding: 0 8px;
}

@media screen and (max-width: 650px) {
  .column {
    width: 100%;
    display: block;
  }
}

.card {
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
}

.container {
  padding: 0 16px;
}

.container::after, .row::after {
  content: "";
  clear: both;
  display: table;
}

.title {
  color: grey;
}

.button {
  border: none;
  outline: 0;
  display: inline-block;
  padding: 8px;
  color: white;
  background-color: #000;
  text-align: center;
  cursor: pointer;
  width: 100%;
}

.button:hover {
  background-color: #555;
}
.center {
  display: block;
  margin-left: auto;
  margin-right: auto;
  width: 70%;
}

</style>
</head>
<body>
    <div class="container">
        <div id="Scanvideo" > 
            <button class="button"onclick="test()">Scan</button>     
            <video id="preview" playsinline="true" class="center" ></video>
            <div class="row" id="Checkshet" style="display: none;">
            </div>
        </div>
</div>







</body>
<script src="js/intascan.js"></script>
<script src="js/intascan.min.js"></script>
<script>
     
   var url = "https://big-road-newsstand.glitch.me/CheckSheet/"



    var scanner = new Instascan.Scanner({ video: document.getElementById('preview'), mirror: false  })
      scanner.addListener('scan',function(content){
        scanner.stop() 
     $.get(url+content, function(ketqua) {
        document.getElementById("preview").style.display = "none"
        
        if(ketqua.PhanLoai=="ThietBiDungChung"){setthietbidungchung(ketqua)}
        if(ketqua.PhanLoai=="KhuVucDungChung"){setkhuvucdungchung(ketqua)}
     });
 
    });

    function test(){
      $.get(url+"KhoangEM1", function(ketqua) {
        document.getElementById("preview").style.display = "none"
        
        if(ketqua.PhanLoai=="ThietBiDungChung"){setthietbidungchung(ketqua)}
        if(ketqua.PhanLoai=="KhuVucDungChung"){setkhuvucdungchung(ketqua)}
     });
    }
    function showScan(){ 
      document.getElementById("preview").style.display = "block"
      document.getElementById("Checkshet").style.display = "none";
    Instascan.Camera.getCameras().then(function (cameras) {
                 if (cameras.length > 0) {
                     scanner.start(cameras[0]);
                     //load2.hidden =true
                 }
                 else {
            alert('No Back camera found!');       
                 }
             }).catch (function (e) {
                console.error('No cameras found.');
             });
    }
    function setkhuvucdungchung(ketqua){
            $("#Checkshet").html(
                //'<div class="column">'+
                    '<div class="card">'+
                        '<img src="images/'+ketqua.id+'.jpg" alt="'+ketqua.id+'" style="width:100%">'+
                        '<div class="container">'+
                            '<h2>'+ketqua.TenKhuVuc+'</h2>'+
                            set5sKhuVuc(ketqua.TrangThietBi)+
                            '<p><button class="button">Contact</button></p>'+
                            
                        '</div>'+
                    //'</div>'+
                '</div>')
      document.getElementById("Checkshet").style.display = "block";
    }

    function set5sKhuVuc(value){     
    var cac5s ='<p class="title">5S</p>'
   
    for(a in value){
     var value2 = value[a] 
     for(b in value2){
      cac5s +='<p class="title">'+value2[b].TenThietBi+'</p>'
      for (c in value2[b].tieuchuan5s){
      cac5s +='<p>'+value2[b].tieuchuan5s[c]+'</p>'}
     }
      }
      return cac5s
    }






    function setthietbidungchung(ketqua){
            $("#Checkshet").html(
                //'<div class="column">'+
                    '<div class="card">'+
                        '<img src="images/'+ketqua.id+'.jpg" alt="'+ketqua.id+'" style="width:100%">'+
                        '<div class="container">'+
                            '<h2>'+ketqua.TenThietBi+'</h2>'+
                            set5s(ketqua.tieuchuan5s)+
                            setBasic(ketqua.Basic)+
                            '<p><button class="button">Contact</button></p>'+
                        '</div>'+
                    //'</div>'+
                '</div>')
      document.getElementById("Checkshet").style.display = "block";
    }

    function set5s(value){     
    var cac5s ='<p class="title">5S</p>'
    for(a in value){
     cac5s +='<p>'+value[a]+'</p>'
      }
      return cac5s
    }

    function setBasic(value){     
    var Basic ='<p class="title">Basic</p>'
    for(a in value){
      Basic +='<p>'+value[a]+'</p>'
      }
      return Basic
    }
</script>
</html>
